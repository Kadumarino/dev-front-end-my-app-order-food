<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#7cb342">
  
  <!-- Script para aplicar tema antes do carregamento completo -->
  <script>
    // Aplica o tema imediatamente para evitar flash
    (function() {
      const theme = localStorage.getItem('theme');
      if (theme === 'dark') {
        document.documentElement.classList.add('dark-mode');
      }
    })();
  </script>
  
  <!-- Content Security Policy -->
  <meta http-equiv="Content-Security-Policy" content="
    default-src 'self';
    script-src 'self' 'unsafe-inline';
    style-src 'self' https://fonts.googleapis.com;
    font-src 'self' https://fonts.gstatic.com;
    img-src 'self' https: data:;
    connect-src 'self' https://api.whatsapp.com https://web.whatsapp.com;
    frame-src 'none';
    object-src 'none';
    base-uri 'self';
    form-action 'self';
  ">
  
  <link rel="manifest" href="manifest.json">
  <title>ğŸ” Kadu Lanches - Pagamento</title>
  
  <!-- Font Optimization -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <!-- Preload da fonte principal para evitar FOUT -->
  <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;500;600;700&display=swap">
  <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;500;600;700&display=swap" rel="stylesheet" media="print">
  <noscript>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;500;600;700&display=swap" rel="stylesheet">
  </noscript>
  
  <!-- Critical CSS -->
  <link rel="stylesheet" href="src/styles/main.css">
</head>
<body>
  <header class="flow-header">
    <button class="close-flow" id="btn-voltar" aria-label="Voltar para dados de entrega">â†</button>
    <h2>ğŸ’³ Forma de Pagamento</h2>
    <button id="theme-toggle" aria-label="Alternar tema escuro/claro" aria-pressed="false">ğŸŒ™</button>
  </header>

  <section class="flow-section">
    <div class="flow-content">
      <div class="payment-info">
        <h3 class="payment-header-title">ğŸ’³ Pagamento na Entrega</h3>
        <p class="payment-header-subtitle">Selecione a forma de pagamento:</p>
      </div>
      
      <div class="payment-methods">
        <div class="pay-card" data-method="credito" role="button" tabindex="0" aria-label="Pagar com cartÃ£o de crÃ©dito na entrega">
          <div class="pay-title">ğŸ’³ CrÃ©dito</div>
          <p>Pagar com cartÃ£o de crÃ©dito na entrega.</p>
        </div>
        <div class="pay-card" data-method="debito" role="button" tabindex="0" aria-label="Pagar com cartÃ£o de dÃ©bito na entrega">
          <div class="pay-title">ğŸ’³ DÃ©bito</div>
          <p>Pagar com cartÃ£o de dÃ©bito na entrega.</p>
        </div>
        <div class="pay-card" data-method="dinheiro" role="button" tabindex="0" aria-label="Pagar em dinheiro na entrega">
          <div class="pay-title">ğŸ’µ Dinheiro</div>
          <p>Pagar em dinheiro na entrega.</p>
        </div>
        <div class="pay-card" data-method="pix" role="button" tabindex="0" aria-label="Pagar com PIX na entrega">
          <div class="pay-title">ğŸ“± PIX</div>
          <p>Pagar com PIX na entrega.</p>
        </div>
      </div>
      
      <div id="payment-details" class="payment-details"></div>
      
      <div class="flow-actions">
        <button id="finish-order" class="btn-primary">Finalizar e enviar WhatsApp</button>
      </div>
    </div>
  </section>
  
  <!-- Scripts: Ordem de carregamento Ã© importante -->
  <script src="js/config.js"></script>
  <script src="js/security.js"></script>
  <script src="js/notification.js"></script>
  
  <!-- Models -->
  <script src="src/scripts/models/MenuItem.js"></script>
  <script src="src/scripts/models/CartItem.js"></script>
  <script src="src/scripts/models/User.js"></script>
  <script src="src/scripts/models/Payment.js"></script>
  
  <!-- Services -->
  <script src="src/scripts/services/Store.js"></script>
  
  <!-- Shared Functions -->
  <script src="js/shared.js"></script>
  
  <!-- Controllers -->
  <!-- <script src="src/scripts/controllers/PaymentController.js"></script> -->
  
  <!-- App Init -->
  <!-- <script src="src/scripts/app.js"></script> -->
  
  <!-- Pagamento especÃ­fico -->
  <script src="js/pagamento.js"></script>
  
  <!-- Pull to Refresh -->
  <script src="js/pull-refresh.js"></script>
  
  <!-- Font Async Load -->
  <script src="js/font-loader.js"></script>
</body>
</html>
